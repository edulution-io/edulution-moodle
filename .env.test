# =====================================================
# EDULUTION MOODLE - TEST KONFIGURATION
# =====================================================
# Diese Datei enthaelt sichere Test-Werte.
# Zum Testen:
#   cp .env.test .env
#   docker compose -f docker-compose.test.yml up -d
#
# ACHTUNG: Nur fuer lokale Tests verwenden!
# Fuer Produktion: Kopiere .env.example und passe an.
# =====================================================


# =====================================================
# MOODLE GRUNDKONFIGURATION
# =====================================================

# URL unter der Moodle erreichbar ist
MOODLE_WWWROOT=http://localhost:8080

# Port fuer HTTP-Zugriff
MOODLE_PORT=8080

# Name der Moodle-Instanz
MOODLE_SITE_NAME=Test Moodle

# Admin-Benutzer
MOODLE_ADMIN_USER=admin
MOODLE_ADMIN_PASSWORD=Admin123!
MOODLE_ADMIN_EMAIL=admin@test.local

# Sprache
MOODLE_DEFAULT_LANGUAGE=de


# =====================================================
# DATENBANK (Test-Werte)
# =====================================================

DB_NAME=moodle
DB_USER=moodle
DB_PASSWORD=moodle_test_password
DB_ROOT_PASSWORD=root_test_password


# =====================================================
# KEYCLOAK SSO (optional)
# =====================================================
# Leer lassen fuer Tests ohne SSO.
# Zum Testen mit Keycloak: Werte ausfuellen.

# Keycloak Server URL (mit /auth/ am Ende falls Keycloak < 17)
KEYCLOAK_SERVER_URL=

# Keycloak Realm Name
KEYCLOAK_REALM=edulution

# Client ID fuer Sync
KEYCLOAK_CLIENT_ID=edu-moodle-sync

# Client Secret (ERFORDERLICH fuer Sync!)
KEYCLOAK_SECRET_KEY=

# SSL pruefen (0=nein fuer lokale Tests)
KEYCLOAK_VERIFY_SSL=0


# =====================================================
# SYNC KONFIGURATION
# =====================================================

# Sync aktivieren (0=aus, 1=an)
# Setze auf 1 wenn Keycloak konfiguriert ist
SYNC_ENABLED=0

# Sync-Intervall in Sekunden
SYNC_INTERVAL=300

# Dry-Run: Zeigt was passieren wuerde ohne Aenderungen
# WICHTIG: Erst mit DRY_RUN=1 testen!
DRY_RUN=1


# =====================================================
# USER SYNC
# =====================================================

# Welche Keycloak-Gruppen synchronisieren
SYNC_USERS_IN_GROUPS=role-schooladministrator,role-teacher,role-student

# Diese User nie synchronisieren
IGNORE_USERS=admin,guest,root

# Diese User nie loeschen
PROTECTED_USERS=admin,guest


# =====================================================
# ROLLEN-MAPPING
# =====================================================

# Schueler
ROLE_STUDENT_GROUPS=role-student
ROLE_STUDENT_MOODLE=student

# Lehrer
ROLE_TEACHER_GROUPS=role-teacher
ROLE_TEACHER_MOODLE=editingteacher

# Schuladministratoren
ROLE_MANAGER_GROUPS=role-schooladministrator
ROLE_MANAGER_MOODLE=manager


# =====================================================
# SOFT-DELETE
# =====================================================

# User erst deaktivieren statt direkt loeschen
SOFT_DELETE_ENABLED=1

# Wartezeit vor endgueltigem Loeschen (30 Tage)
SOFT_DELETE_GRACE_PERIOD=2592000

# Echtes Loeschen (VORSICHT!)
DELETE_ENABLED=0


# =====================================================
# REDIS
# =====================================================

REDIS_HOST=redis
REDIS_PORT=6379
